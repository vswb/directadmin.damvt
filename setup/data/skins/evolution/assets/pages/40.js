(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1433:function(t,e,n){"use strict";n.r(e);var a=n(3169),o=n(2293);for(var r in o)"default"!==r&&function(t){n.d(e,t,(function(){return o[t]}))}(r);n(3003);var i=n(0),s=n(3005),l=n.n(s),d=Object(i.a)(o.default,a.a,a.b,!1,null,"8bb77e98",null);"function"==typeof l.a&&l()(d),e.default=d.exports},1442:function(t,e,n){"use strict";var a=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.validateIPRangeList=e.validateDomain=e.validatePassword=e.validateSubdomain=e.validateUsername=e.validateDBUser=e.validateDatabase=e.validateDNSName=e.validateMXValue=e.validateDNSValue=e.validateFTP=e.validateEmail=e.validateForwarder=void 0;var o=a(n(30)),r=a(n(36)),i=a(n(1443)),s=o.default.get({url:"/CMD_JSON_VALIDATE",schema:{value:o.default.REQUIRED_STRING},response:{valid:!0,message:""},mapResponse:{valid:i.default.isValid,message:i.default.getMessage}}),l=s.extend({id:"VALIDATE_FORWARDER",params:{type:"forwarder",ignore_system_default:!0}});e.validateForwarder=l;var d=s.extend({id:"VALIDATE_EMAIL",params:{type:"email",check_mailing_list:!0},schema:{check_exists:{type:Boolean,required:!1,default:!0}}});e.validateEmail=d;var u=s.extend({id:"VALIDATE_FTP",params:{type:"ftp"},domain:!0});e.validateFTP=u;var c=s.extend({params:{type:"dns"},domain:!0,schema:{record:o.default.REQUIRED_STRING}}),m=c.extend({id:"VALIDATE_DNS_VALUE",params:{check:"value",name:!0},domain:!0,schema:{value:o.default.REQUIRED_STRING}});e.validateDNSValue=m;var p=m.extend({id:"VALIDATE_MX_VALUE",params:{record:"MX"},before:function(t){return{value:"10",mx_value:t.value}}});e.validateMXValue=p;var v=c.extend({id:"VALIDATE_DNS_NAME",params:{check:"name",value:!0,mx_value:!0},schema:{name:o.default.REQUIRED_STRING,value:null}});e.validateDNSName=v;var b=s.extend({id:"VALIDATE_DATABASE",params:{type:"dbname"}});e.validateDatabase=b;var f=s.extend({id:"VALIDATE_DATABASE_USER",params:{type:"dbusername"}});e.validateDBUser=f;var _=s.extend({id:"VALIDATE_USERNAME",params:{type:"username"}});e.validateUsername=_;var h=s.extend({id:"VALIDATE_SUBDOMAIN",domain:!0,params:{type:"subdomain"}});e.validateSubdomain=h;var D=s.extend({id:"VALIDATE_PASSWORD",params:{type:"password"}});e.validatePassword=D;var A=s.extend({id:"VALIDATE_DOMAIN",params:{type:"domain"},before:function(t){var e=t.value;return{value:r.default.toASCII(e)}}});e.validateDomain=A;var g=s.extend({id:"VALIDATE_IP_RANGE_LIST",params:{type:"ip_range_list"}});e.validateIPRangeList=g},1443:function(t,e,n){"use strict";n.r(e);var a=n(35);e.default={isValid:function(t){return void 0===t.error},getMessage:function(t){return Object(a.toAppHtml)(t.error||"")}}},1482:function(t,e,n){"use strict";var a=n(10),o=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.getPhpDocrootOptions=e.phpOverride=e.docrootOverride=e.getSubdomainLog=e.deleteSubdomains=e.createSubdomain=e.getSubdomains=void 0;var r=o(n(2)),i=o(n(30));a(n(6));function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}var l=i.default.get({id:"GET_SUBDOMAINS",url:"/CMD_SUBDOMAIN",schema:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){(0,r.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({domain:i.default.DOMAIN},i.default.PAGINATION),after:function(t){return t.flow(t.moveProp("subdomains","rows"),t.moveProp("allow_subdomain_docroot_override","docroot"),t.processTableInfo("rows"),t.mapProps({awstats:t.isEqual("1"),webalizer:t.isEqual("1"),docroot:t.isEqual("1"),has_php_selector:t.isEqual("yes"),rows:t.flow(t.toArray,t.mapArray(t.moveProp("subdomain_docroot_override","docroot")),t.mapArrayProps({bandwidth:t.convert.toAppNumber,stats:t.mapProps({webalizer_only:t.convert.toAppBoolean}),docroot:function(e){if(e&&Object.keys(e).length){if(void 0!==e.php1_select){var n=t.toSelect(e.php1_select),a=n.options,o=n.value;return{public_html:e.public_html,private_html:e.private_html,php_labels:a,php1_select:o}}return e}return!1}}))}))}});e.getSubdomains=l;var d=i.default.post({url:"/CMD_SUBDOMAIN",params:{action:"create"},schema:{domain:i.default.DOMAIN,subdomain:i.default.REQUIRED_STRING}});e.createSubdomain=d;var u=i.default.select({url:"/CMD_SUBDOMAIN",params:{action:"delete"},domain:!0,body:{contents:i.default.REQUIRED_BOOL}});e.deleteSubdomains=u;var c=i.default.get({id:"GET_SUBDOMAIN_LOG",url:"/CMD_SHOW_LOG",params:{json:null},accept:"text/plain",schema:{domain:i.default.DOMAIN,type:i.default.REQUIRED_STRING,subdomain:i.default.REQUIRED_STRING,lines:i.default.OPTIONAL_STRING},after:function(t){return t.flow(t.convert.toLines,(function(t){return t.slice(0,-1)}))}});e.getSubdomainLog=c;var m=i.default.post({url:"/CMD_SUBDOMAIN",params:{action:"document_root_override"},domain:!0,schema:{subdomain:i.default.REQUIRED_STRING,private_html:i.default.OPTIONAL_STRING,public_html:i.default.OPTIONAL_STRING}});e.docrootOverride=m;var p=i.default.post({url:"/CMD_SUBDOMAIN",domain:!0,params:{action:"php_selector"},schema:{subdomain:i.default.REQUIRED_STRING,php1_select:i.default.REQUIRED_STRING}});e.phpOverride=p;var v=i.default.get({url:"/CMD_SUBDOMAIN",id:"SUBDOMAIN_DATA",domain:!0,params:{action:"show_docroot_override"},schema:{subdomain:i.default.REQUIRED_STRING},after:function(t){return t.flow(t.project({has_php_selector:"has_php_selector",http:"public_html",https:"private_html",php:"php1_select"}),t.mapProps({php:t.toSelect,has_php_selector:t.isEqual("yes")}))}});e.getPhpDocrootOptions=v},2293:function(t,e,n){"use strict";n.r(e);var a=n(2294),o=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e.default=o.a},2294:function(t,e,n){"use strict";var a=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,r=a(n(15)),i=a(n(16)),s=n(1482),l=n(1442),d=a(n(3002)),u={preload:s.getSubdomains,commands:{getSubdomains:s.getSubdomains,validateSubdomain:l.validateSubdomain},components:{DocrootOverrideDialog:d.default},api:[{command:s.getSubdomains,bind:"subdomains"}],data:function(){return{newSubdomain:"",removeDir:!1,select:[],docrootOverride:{sub:"",data:{public_html:"",private_html:""}}}},computed:{awstats:function(){return this.$api.subdomains.awstats},webalizer:function(){return this.$api.subdomains.webalizer},rowsCount:function(){return this.$api.subdomains.rowsCount},docrootOverrideEnabled:function(){return this.$api.subdomains.docroot}},watch:{$domain:function(){(0,s.getSubdomains)(),this.select=[]}},methods:{getSubdomains:s.getSubdomains,deleteSubdomains:function(){(0,s.deleteSubdomains)({select:this.select,contents:this.removeDir}).then(this.$reset).then(s.getSubdomains)},createSubdomain:(o=(0,i.default)(r.default.mark((function t(){var e;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=this.$p6e.toA(this.newSubdomain))!==this.newSubdomain&&this.$notifications.info({title:this.$gettext("Subdomain name punycoded"),content:this.$gettext("Subdomain name has been automatically converted to punycode format. Punycode is used to encode internationalized domain names (IDN) by converting Unicode characters to ASCII.")}),t.next=4,(0,s.createSubdomain)({subdomain:e});case 4:(0,s.getSubdomains)(),this.$reset();case 6:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),openDocrootDialog:function(t,e){Object.assign(this.docrootOverride,{sub:t,data:e}),this.$dialog("DOCUMENT_ROOT_OVERRIDE_DIALOG").open()}}};e.default=u},2295:function(t,e,n){"use strict";n.r(e);var a=n(2296),o=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e.default=o.a},2296:function(t,e,n){"use strict";var a=n(10),o=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i,s=o(n(15)),l=o(n(16)),d=n(656),u=n(1482),c=a(n(6)),m={props:{sub:{type:String,required:!0,default:""},data:{type:Object,required:!0,default:function(){return{private_html:"",public_html:""}}}},data:function(){return{overridePrivateHtml:!1,privateHtml:"",overridePublicHtml:!1,publicHtml:"",dirs:[]}},methods:{initData:function(){this.publicHtml=(this.data.public_html||"").replace("/domains/",""),this.privateHtml=(this.data.private_html||"").replace("/domains/",""),this.overridePublicHtml=Boolean(this.data.public_html),this.overridePrivateHtml=Boolean(this.data.private_html),this.loadDirs()},loadDirs:(i=(0,l.default)(s.default.mark((function t(){var e;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,d.getFolderTree)({path:"/domains",action:"tree"});case 2:e=t.sent,this.dirs=c.pipe(c.map(c.prop("path")),c.filter(c.startsWith("/domains/")))(e);case 4:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)}),validateDir:function(t){return!t||this.dirs.includes("/domains/".concat(t))},submit:(r=(0,l.default)(s.default.mark((function t(){var e;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={subdomain:this.sub,public_html:this.overridePublicHtml?"/domains/".concat(this.publicHtml):this.publicHtml?"":null,private_html:this.overridePrivateHtml?"/domains/".concat(this.privateHtml):this.privateHtml?"":null},t.next=3,(0,u.docrootOverride)(e);case 3:this.$emit("update");case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}};e.default=m},2297:function(t,e,n){var a=n(3004);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n(5).default)("b6776ac0",a,!0,{})},3002:function(t,e,n){"use strict";n.r(e);var a=n(3289),o=n(2295);for(var r in o)"default"!==r&&function(t){n.d(e,t,(function(){return o[t]}))}(r);var i=n(0),s=Object(i.a)(o.default,a.a,a.b,!1,null,null,null);e.default=s.exports},3003:function(t,e,n){"use strict";var a=n(2297);n.n(a).a},3004:function(t,e,n){(t.exports=n(4)(!0)).push([t.i,".docroot-table[data-v-8bb77e98]{margin-bottom:0;margin-top:0}.docroot-table>tr[data-v-8bb77e98]{background:transparent!important}.docroot-table>tr>td[data-v-8bb77e98]{height:auto;padding:0 .5rem;border-width:0}.docroot-table>tr>td.font\\:monospace[data-v-8bb77e98]{font-family:Courier New,Courier,monospace}","",{version:3,sources:["/home/evo/evolution/src/js/pages/user/subdomains/index.vue"],names:[],mappings:"AAyRA,gCACI,gBACA,YAAa,CAFjB,mCAIQ,gCAAkC,CAJ1C,sCAMY,YACA,gBACA,cAAe,CAR3B,sDAWgB,yCAA8C,CAAA",file:"index.vue?vue&type=style&index=0&id=8bb77e98&lang=scss&scoped=true&",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.docroot-table {\n    margin-bottom: 0;\n    margin-top: 0;\n    & > tr {\n        background: transparent !important;\n        & > td {\n            height: auto;\n            padding: 0 0.5rem;\n            border-width: 0;\n\n            &.font\\:monospace {\n                font-family: 'Courier New', Courier, monospace;\n            }\n        }\n    }\n}\n"],sourceRoot:""}])},3005:function(t,e){},3169:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-page",[n("ui-tokens-conditional-button",{attrs:{slot:"header:buttons",theme:"safe",token:"NUSERSUBDOMAINSMAX",usage:t.rowsCount},on:{click:function(e){t.$dialog("ADD_SUBDOMAIN_DIALOG").open()}},slot:"header:buttons"},[n("translate",[t._v("Add Subdomain")]),t._v(" "),n("translate",{attrs:{slot:"limitText"},slot:"limitText"},[t._v("\n            Sub-Domains Limit Reached\n        ")])],1),t._v(" "),n("app-page-section",[n("ui-api-table",t._b({on:{"action:delete":function(e){t.$dialog("DELETE_ITEMS_DIALOG").open()}},scopedSlots:t._u([{key:"col:subdomain_name",fn:function(e){var n=e.subdomain_name;return[t._v("\n                "+t._s(t.$p6e.toU(n))+"."+t._s(t.$domainUnicode)+"\n            ")]}},{key:"col:docroot",fn:function(e){var a=e.docroot,o=e.subdomain_name;return n("div",{directives:[{name:"flex",rawName:"v-flex",value:{cross:"center",main:"start"},expression:"{ cross: 'center', main: 'start' }"}]},[!1===a?n("ui-badge",{key:"default-docroot",attrs:{theme:"safe"}},[n("translate",[t._v("Default")])],1):n("ui-tooltip",{attrs:{theme:"danger"}},[n("ui-badge",{key:"custom-docroot",attrs:{slot:"trigger",theme:"danger"},slot:"trigger"},[n("translate",[t._v("Custom")])],1),t._v(" "),n("table",{staticClass:"docroot-table"},[a.public_html?n("tr",[n("td",{staticClass:"txt:bold",attrs:{width:"40"}},[t._v("\n                                http:\n                            ")]),t._v(" "),n("td",{staticClass:"font:monospace"},[t._v("\n                                "+t._s(a.public_html||t.$gettext("default"))+"\n                            ")])]):t._e(),t._v(" "),a.private_html?n("tr",[n("td",{staticClass:"txt:bold"},[t._v("\n                                https:\n                            ")]),t._v(" "),n("td",{staticClass:"font:monospace"},[t._v("\n                                "+t._s(a.private_html||t.$gettext("default"))+"\n                            ")])]):t._e(),t._v(" "),a.php1_select?n("tr",[n("td",{staticClass:"txt:bold"},[t._v("\n                                php:\n                            ")]),t._v(" "),n("td",{staticClass:"font:monospace"},[t._v("\n                                "+t._s(a.php_labels[a.php1_select])+"\n                            ")])]):t._e()])],1),t._v(" "),n("ui-button-icon",{directives:[{name:"margin",rawName:"v-margin:left",value:1,expression:"1",arg:"left"}],attrs:{icon:"pencil",title:t.$gettext("Change"),theme:"primary"},on:{click:function(e){return t.$router.push({name:"user/subdomains/docroot",params:{subdomain:o}})}}})],1)}},{key:"row:actions",fn:function(e){var a=e.item;return n("ui-actions",{},[n("ui-link",{attrs:{name:"user/subdomains/stats",params:{subdomain:a.subdomain_name}}},[n("translate",[t._v("Stats")])],1),t._v(" "),n("ui-link",{attrs:{name:"user/subdomains/logs",params:{subdomain:a.subdomain_name,type:"usage"}}},[n("translate",[t._v("Usage Log")])],1),t._v(" "),n("ui-link",{attrs:{name:"user/subdomains/logs",params:{subdomain:a.subdomain_name,type:"error"}}},[n("translate",[t._v("Error Log")])],1)],1)}}]),model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},"ui-api-table",{command:t.$commands.getSubdomains,rowID:"subdomain_name",columns:{subdomain_name:{label:t.$gettext("Subdomain Name"),grow:!0},bandwidth:{label:t.$gettext("Bandwidth"),filter:["humanReadableSize"]},docroot:{label:t.$gettext("Docroot"),hide:!t.docrootOverrideEnabled}},actions:{delete:t.$gettext("Delete")},updateOn:["CREATE_SUBDOMAIN","DELETE_SUBDOMAINS"],verticalLayout:t.$_Client.isPhone},!1))],1),t._v(" "),n("ui-dialog",{attrs:{id:"ADD_SUBDOMAIN_DIALOG"}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n            Add New Subdomain\n        ")]),t._v(" "),n("ui-form-element",{attrs:{slot:"content",vertical:"",group:"createSubdomain",validators:{required:!0,api:t.$commands.validateSubdomain}},slot:"content"},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Subdomain:\n            ")]),t._v(" "),n("input-text",{attrs:{slot:"content",suffix:"."+t.$p6e.toU(t.$domain)},slot:"content",model:{value:t.newSubdomain,callback:function(e){t.newSubdomain=e},expression:"newSubdomain"}})],1),t._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"safe","validate-group":"createSubdomain"},on:{click:t.createSubdomain},slot:"buttons"},[n("translate",[t._v("Add Subdomain")])],1)],1),t._v(" "),n("ui-dialog-delete-items",{attrs:{subject:t.$ngettext("subdomain","subdomains",t.select.length)},on:{"click:confirm":t.deleteSubdomains}},[n("input-checkbox",{model:{value:t.removeDir,callback:function(e){t.removeDir=e},expression:"removeDir"}},[n("translate",[t._v("Remove Directory Content")])],1)],1),t._v(" "),t.docrootOverrideEnabled?n("docroot-override-dialog",t._b({on:{update:t.getSubdomains}},"docroot-override-dialog",t.docrootOverride,!1)):t._e()],1)},o=[];n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return o}))},3289:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-dialog",{attrs:{id:"DOCUMENT_ROOT_OVERRIDE_DIALOG",size:"small"},on:{"dialog:open":t.initData}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n        Document Root Override\n    ")]),t._v(" "),n("div",{attrs:{slot:"content"},slot:"content"},[n("ui-form-element",{attrs:{vertical:""}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Subdomain\n            ")]),t._v(" "),n("input-text",{attrs:{slot:"content",value:"sub."+t.$domainUnicode,disabled:""},slot:"content"})],1),t._v(" "),n("ui-form-element",{attrs:{group:"docroot-override",validators:{required:!0,validateDir:t.validateDir},vertical:""}},[n("input-checkbox",{attrs:{slot:"title"},slot:"title",model:{value:t.overridePublicHtml,callback:function(e){t.overridePublicHtml=e},expression:"overridePublicHtml"}},[n("translate",[t._v("\n                    Override public HTML document root\n                ")])],1),t._v(" "),t.overridePublicHtml?n("input-autocomplete",{attrs:{slot:"content",prefix:"/domains/",values:t.dirs},slot:"content",model:{value:t.publicHtml,callback:function(e){t.publicHtml=e},expression:"publicHtml"}}):t._e(),t._v(" "),n("translate",{attrs:{slot:"error:validateDir"},slot:"error:validateDir"},[t._v("\n                Folder does not exist\n            ")])],1),t._v(" "),n("ui-form-element",{attrs:{group:"docroot-override",validators:{required:!0,validateDir:t.validateDir},vertical:""}},[n("input-checkbox",{attrs:{slot:"title"},slot:"title",model:{value:t.overridePrivateHtml,callback:function(e){t.overridePrivateHtml=e},expression:"overridePrivateHtml"}},[n("translate",[t._v("\n                    Override private HTML document root\n                ")])],1),t._v(" "),t.overridePrivateHtml?n("input-text",{attrs:{slot:"content",prefix:"/domains/"},slot:"content",model:{value:t.privateHtml,callback:function(e){t.privateHtml=e},expression:"privateHtml"}}):t._e(),t._v(" "),n("translate",{attrs:{slot:"error:validateDir"},slot:"error:validateDir"},[t._v("\n                Folder does not exist\n            ")])],1)],1),t._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"primary","validate-group":"docroot-override"},on:{click:t.submit},slot:"buttons"},[n("translate",[t._v("Save")])],1)],1)},o=[];n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return o}))}}]);