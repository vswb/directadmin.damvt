(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{1296:function(t,e,r){"use strict";r.r(e);var s=r(3035),i=r(1605);for(var o in i)"default"!==o&&function(t){r.d(e,t,(function(){return i[t]}))}(o);var n=r(0),a=r(2496),l=r.n(a),u=Object(n.a)(i.default,s.a,s.b,!1,null,null,null);"function"==typeof l.a&&l()(u),e.default=u.exports},1446:function(t,e,r){"use strict";var s=r(1);Object.defineProperty(e,"__esModule",{value:!0}),e.unblock=e.block=e.unskip=e.skip=e.getBlockList=e.getSkipList=e.getUserList=e.getIpList=e.getGeneralList=e.getIpInfo=e.getDefaults=void 0;var i=s(r(2)),o=s(r(30));function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,s)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){(0,i.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var l="/CMD_BRUTE_FORCE_MONITOR",u=function(t,e){return o.default.get(a({id:t,url:l},e))},c=function(t,e){return o.default.post({url:l,params:{action:t},schema:e})},p=u("BFM_DEFAULTS",{params:{seek_value:"-1"},after:function(t){return t.flow(t.project({logsize:"BRUTE_LOG_SIZE",userLimit:"USER_LIMIT",ipLimit:"IP_LIMIT",logScanning:"LOG_SCANNING",subjects:"SUBJECT_SELECT",defaultSubject:"SUBJECT_SELECT","scripts.block":"HAVE_BLOCK_SH","scripts.unblock":"HAVE_UNBLOCK_SH","scripts.show_blocked_ips":"HAVE_SHOW_BLOCKED_IPS_SH"}),t.mapProps({logScanning:t.convert.toAppBoolean,subjects:t.toSelect,defaultSubject:t.flow(t.find(t.getProp("selected")),t.getProp("value")),scripts:t.mapValues(t.isEqual("1"))}))}});e.getDefaults=p;var f=u("BFM_IPINFO",{schema:{ipinfo:o.default.REQUIRED_STRING},after:function(t){return t.flow(t.project({ip:"BLOCK_IP",data:"info"}),t.mapProp("data",t.flow(t.convert.toLines,t.filter(t.notEmpty))))}});e.getIpInfo=f;var d=u("BFM_GENERAL_LIST",{params:{show:"LOGINFAILURES"},pagination:!0,schema:{filter:o.default.OPTIONAL_STRING,value:o.default.OPTIONAL_STRING},before:function(t){var e=t.filter,r=t.value,s={};if(t.sort||(s.sort1="-1"),e){var i="ip"===e?2:3;s["comparison".concat(i)]="equals",s["value".concat(i)]=r}return s},after:function(t){return t.flow(t.project({rows:"LOGINFAILURES"}),t.processTableInfo("rows"),t.mapProp("rows",t.toArray),t.mapProp("rows",t.mapArray((function(t){return a({},t,{date:new Date(Number(t.id.slice(0,13))),index:Number(t.id.slice(13))})}))))}});e.getGeneralList=d;var m=u("BFM_IPLIST",{params:{show:"IPLOGINFAILURES",sort1:-2},pagination:!0,after:function(t){return t.flow(t.project({rows:"IPLOGINFAILURES"}),t.processTableInfo("rows"),t.mapProp("rows",t.flow(t.toArray,t.mapArray(t.project({ip:"ip",failures:"login_failures",first:"first_entry",last:"last_entry",notified:"notified",blocked:"blocked"})),t.mapArrayProps({first:t.convert.toAppDate,last:t.convert.toAppDate,notified:t.isEqual("Yes"),blocked:t.isEqual("Yes")}))))}});e.getIpList=m;var v=u("BFM_USER_LIST",{params:{show:"USERLOGINFAILURES",sort1:-2},pagination:!0,after:function(t){return t.flow(t.project({rows:"USERLOGINFAILURES"}),t.processTableInfo("rows"),t.mapProp("rows",t.flow(t.toArray,t.mapArrayProps({first_entry:t.convert.toAppDate,last_entry:t.convert.toAppDate,notified:t.isEqual("Yes")}))))}});e.getUserList=v;var _=u("BFM_SKIP_LIST",{params:{show:"SKIPLIST"},pagination:!0,after:function(t){return t.flow(t.project({rows:"SKIPLIST"}),t.processTableInfo("rows"),t.mapProp("rows",t.flow(t.toArray,t.mapArray(t.flow(t.moveProp("when","date"),t.mapProp("date",t.convert.toAppDate))))))}});e.getSkipList=_;var b=u("BFM_BLOCK_LIST",{params:{show:"BLOCKED_IPS"},pagination:!0,after:function(t){return t.flow(t.project({rows:"BLOCKED_IPS"}),t.processTableInfo("rows"),t.mapProp("rows",t.toArray),t.mapProp("rows",t.mapArray(t.deleteProp("ip_info"),t.mapProp("date_blocked",t.convert.toAppDate))))}});e.getBlockList=b;var g={type:Array,required:!1},h=o.default.OPTIONAL_STRING,I=c("skiplist",{ip:g,user:g,comments:h,skip_value:h});e.skip=I;var L=c("remove_from_skiplist",{select:o.default.ROWS});e.unskip=L;var S=c("block_ips",{ip:g,user:g});e.block=S;var k=c("unblock",{ip:o.default.ROWS});e.unblock=k},1447:function(t,e,r){"use strict";r.r(e);var s=r(1448),i=r.n(s);for(var o in s)"default"!==o&&function(t){r.d(e,t,(function(){return s[t]}))}(o);e.default=i.a},1448:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={api:[{command:r(1446).getDefaults,bind:{"response.scripts":"scripts"}}],props:{id:{type:String,required:!0},filter:{type:Object,required:!1}},methods:{changeTab:function(t){var e=this,r="general"===t?"admin/brute-force-monitor":"admin/brute-force-monitor/".concat(t);r!==this.$route.name&&(this.$router.push({name:r}),this.$nextTick((function(){e.$refs.tabs.dataCurrentTab=e.id})))}},computed:{filterMessage:function(){if(this.filter){if("ip"===this.filter.filter)return this.$gettextInterpolate(this.$gettext("List filtered by IP: %{ ip }"),{ip:this.filter.value});if("user"===this.filter.filter)return this.$gettextInterpolate(this.$gettext("List filtered by User: %{ user } "),{user:this.filter.value})}return this.$gettext("Select IP address or User to filter results")},headers:function(){var t=[{id:"general",label:this.$gettext("Failed Logins"),desc:this.filterMessage},{id:"ip_list",label:this.$gettext("Failed Logins: IP list"),desc:this.$gettext("Select IP to filter results")},{id:"user_list",label:this.$gettext("Failed logins: Usernames List"),desc:this.$gettext("Select username to filter results")},{id:"skip_list",label:this.$gettext("Skip List"),desc:this.$gettext("Skipped IPs / Users")}];return this.$api.scripts.show_blocked_ips&&t.push({id:"block_list",label:this.$gettext("Block List"),desc:this.$gettext("View / Delete Blocked IPs")}),t}}};e.default=s},1483:function(t,e,r){"use strict";r.r(e);var s=r(1491),i=r(1447);for(var o in i)"default"!==o&&function(t){r.d(e,t,(function(){return i[t]}))}(o);var n=r(0),a=Object(n.a)(i.default,s.a,s.b,!1,null,null,null);e.default=a.exports},1491:function(t,e,r){"use strict";var s=function(){var t=this.$createElement,e=this._self._c||t;return e("app-page-section",[e("ui-tabs",{ref:"tabs",attrs:{selected:this.id,tabs:this.headers},on:{"update:selected":this.changeTab}},[e("div",{attrs:{slot:"tab:"+this.id},slot:"tab:"+this.id},[this._t("default")],2)])],1)},i=[];r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return i}))},1605:function(t,e,r){"use strict";r.r(e);var s=r(1606),i=r.n(s);for(var o in s)"default"!==o&&function(t){r.d(e,t,(function(){return s[t]}))}(o);e.default=i.a},1606:function(t,e,r){"use strict";var s=r(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(1446),o=s(r(1483)),n=s(r(2495)),a={preload:[i.getDefaults,i.getSkipList],commands:{getSkipList:i.getSkipList},components:{Tabs:o.default,SkipDialog:n.default},data:function(){return{select:[],showButton:!0}},methods:{addToSkipList:function(t){(0,i.skip)(t).then(this.$reloadApiTable)},removeFromSkipList:function(){(0,i.unskip)({select:this.select}).then(this.$reloadApiTable)}},beforeRouteLeave:function(t,e,r){this.showButton=!1,r()}};e.default=a},1607:function(t,e,r){"use strict";r.r(e);var s=r(1608),i=r.n(s);for(var o in s)"default"!==o&&function(t){r.d(e,t,(function(){return s[t]}))}(o);e.default=i.a},1608:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={data:function(){return{comments:"",skip_value:""}},methods:{submit:function(){this.$emit("skip",{comments:this.comments,skip_value:this.skip_value})}}}},2495:function(t,e,r){"use strict";r.r(e);var s=r(3182),i=r(1607);for(var o in i)"default"!==o&&function(t){r.d(e,t,(function(){return i[t]}))}(o);var n=r(0),a=Object(n.a)(i.default,s.a,s.b,!1,null,null,null);e.default=a.exports},2496:function(t,e){},3035:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("app-page",{attrs:{id:"brute-force-monitor"}},[t.showButton?r("ui-button",{attrs:{slot:"header:buttons",theme:"primary"},on:{click:function(e){t.$dialog("SKIP_DIALOG").open()}},slot:"header:buttons"},[r("translate",[t._v("Add to skip list")])],1):t._e(),t._v(" "),r("tabs",{attrs:{id:"skip_list"}},[r("ui-api-table",t._b({on:{"action:remove":function(e){t.$dialog("REMOVE_FROM_SKIP_LIST_DIALOG").open()}},model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},"ui-api-table",{command:t.$commands.getSkipList,rowID:"ip_user",columns:{ip_user:{label:t.$gettext("IP / User"),grow:!0},date:{label:t.$gettext("Date Added"),filter:"date"},comments:t.$gettext("Comments")},actions:{remove:t.$gettext("Remove")},verticalLayout:t.$_Client.isPhone},!1))],1),t._v(" "),r("ui-dialog",{attrs:{id:"REMOVE_FROM_SKIP_LIST_DIALOG",theme:"danger"}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Remove from Skip List")]),t._v(" "),r("translate",{attrs:{slot:"content"},slot:"content"},[t._v("Are you sure you want to remove selected elements from skip list?")]),t._v(" "),r("ui-button",{attrs:{slot:"buttons",theme:"danger"},on:{click:t.removeFromSkipList},slot:"buttons"},[r("translate",[t._v("Remove")])],1)],1),t._v(" "),r("skip-dialog",{on:{skip:t.addToSkipList}})],1)},i=[];r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return i}))},3182:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ui-dialog",{attrs:{id:"SKIP_DIALOG"}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Add to Skip List")]),t._v(" "),r("div",{attrs:{slot:"content"},slot:"content"},[r("ui-form-element",{attrs:{vertical:""}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("IP / Range / Domain / E-mail")]),t._v(" "),r("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.skip_value,callback:function(e){t.skip_value=e},expression:"skip_value"}})],1),t._v(" "),r("ui-form-element",{attrs:{vertical:""}},[r("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Comments")]),t._v(" "),r("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.comments,callback:function(e){t.comments=e},expression:"comments"}})],1)],1),t._v(" "),r("ui-button",{attrs:{slot:"buttons",theme:"safe"},on:{click:t.submit},slot:"buttons"},[r("translate",[t._v("Add")])],1)],1)},i=[];r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return i}))}}]);