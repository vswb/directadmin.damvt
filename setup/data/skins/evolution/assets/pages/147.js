(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{1422:function(t,e,a){"use strict";a.r(e);var r=a(3158),s=a(2233);for(var n in s)"default"!==n&&function(t){a.d(e,t,(function(){return s[t]}))}(n);var o=a(0),i=a(2963),l=a.n(i),u=Object(o.a)(s.default,r.a,r.b,!1,null,null,null);"function"==typeof l.a&&l()(u),e.default=u.exports},1537:function(t,e,a){"use strict";var r=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.updateName=e.unprotectDirectory=e.deleteUsers=e.addUser=e.getDirectoryInfo=e.getDirectoryStatus=e.getDirectories=e.protectDirectory=void 0;var s=r(a(30)),n="/CMD_FILE_MANAGER",o=s.default.post({url:n,params:{action:"protect",enabled:!0},schema:{path:s.default.REQUIRED_STRING,user:s.default.REQUIRED_STRING,passwd:s.default.REQUIRED_STRING,passwd2:s.default.REQUIRED_STRING}});e.protectDirectory=o;var i=s.default.get({id:"PROTECTED_DIRECTORIES",url:"/CMD_PROTECTED_DIRECTORIES",domain:!0,response:[]});e.getDirectories=i;var l=s.default.get({id:"PROTECTED_DIRECTORY_STATUS",url:n,params:{action:"protect"},schema:{path:s.default.REQUIRED_STRING},response:{protected:!1},after:function(){return function(t){return{protected:!!t.ENABLED}}}});e.getDirectoryStatus=l;var u=l.extend({id:"PROTECTED_DIRECTORY_INFO",pagination:!0,response:{},after:function(t){return t.flow(t.deleteProp("ENABLED"),t.deleteProp("domain"),t.deleteProp("path"),t.processTableInfo("users"),t.moveProp({users:"rows",NAME:"name"}),t.mapProp("rows",t.toArray))}});e.getDirectoryInfo=u;var d=s.default.post({url:n,params:{action:"protect",enabled:!0},schema:{name:s.default.REQUIRED_STRING,path:s.default.REQUIRED_STRING,user:s.default.REQUIRED_STRING,passwd:s.default.REQUIRED_STRING,passwd2:s.default.REQUIRED_STRING}});e.addUser=d;var c=s.default.select({url:n,params:{action:"delete"},schema:{path:s.default.REQUIRED_STRING}});e.deleteUsers=c;var p=s.default.post({url:n,params:{action:"protect"},schema:{name:s.default.REQUIRED_STRING,path:s.default.REQUIRED_STRING}});e.unprotectDirectory=p;var f=s.default.post({url:n,params:{action:"protect",enabled:!0},schema:{name:s.default.REQUIRED_STRING,path:s.default.REQUIRED_STRING}});e.updateName=f},2233:function(t,e,a){"use strict";a.r(e);var r=a(2234),s=a.n(r);for(var n in r)"default"!==n&&function(t){a.d(e,t,(function(){return r[t]}))}(n);e.default=s.a},2234:function(t,e,a){"use strict";var r=a(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s,n,o,i=r(a(15)),l=r(a(16)),u=a(1537),d={preload:u.getDirectoryInfo,api:[{command:u.getDirectoryInfo,bind:"info"}],commands:{getDirectoryInfo:u.getDirectoryInfo},data:function(){return{select:[],name:"",user:"",passwd:""}},computed:{path:function(){return this.$route.query.path},users:function(){return this.$api.info.rows.map((function(t){return t.username}))}},methods:{deleteUsers:(o=(0,l.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.deleteUsers)({select:this.select,path:this.path});case 2:(0,u.getDirectoryInfo)({path:this.path}),this.$reset();case 4:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)}),addUser:(n=(0,l.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.addUser)({path:this.path,user:this.user,passwd:this.passwd,passwd2:this.passwd,name:this.name});case 2:(0,u.getDirectoryInfo)({path:this.path}),this.$reset(),this.name=this.$api.info.name;case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),disableProtection:(s=(0,l.default)(i.default.mark((function t(){return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.unprotectDirectory)({name:this.name,path:this.path});case 2:t.sent&&this.$router.replace({name:"user/protected-directories"});case 4:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)}),updateName:function(){(0,u.updateName)(this.$get(["name","path"]))},validateUsername:function(t){return!this.users.includes(t)}},created:function(){this.name=this.$api.info.name}};e.default=d},2963:function(t,e){},3158:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-page",[a("ui-button",{attrs:{slot:"header:buttons",theme:"danger"},on:{click:function(e){t.$dialog("REMOVE_PROTECTION_DIALOG").open()}},slot:"header:buttons"},[a("translate",[t._v("Remove Protection")])],1),t._v(" "),a("app-page-section",[a("ui-form-element",[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Path:")]),t._v(" "),a("input-text",{attrs:{slot:"content",disabled:"",value:t.path},slot:"content"})],1),t._v(" "),a("ui-form-element",{attrs:{group:"dirName",validators:{required:!0},underline:!1}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Name:")]),t._v(" "),a("input-text",{attrs:{slot:"content",placeholder:t.$gettext("eg. Member's Area")},slot:"content",model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[a("ui-button",{attrs:{slot:"additions:right",theme:"safe",validateGroup:"dirName"},on:{click:t.updateName},slot:"additions:right"},[a("translate",[t._v("Update")])],1)],1)],1),t._v(" "),a("ui-api-table",t._b({attrs:{hideBeforeControls:""},on:{"action:del":function(e){t.$dialog("DELETE_ITEMS_DIALOG").open()}},model:{value:t.select,callback:function(e){t.select=e},expression:"select"}},"ui-api-table",{command:t.$commands.getDirectoryInfo,requestData:{path:t.path},rowID:"username",columns:{username:{label:t.$gettext("Users"),grow:!0}},actions:{del:{label:t.$gettext("Delete"),disabled:t.select.length===t.$api.info.rowsCount}}},!1),[a("ui-grid",{attrs:{slot:"table:after",main:"end"},slot:"table:after"},[a("ui-button",{attrs:{icon:"plus-fill",size:"small",theme:"light"},on:{click:function(e){t.$dialog("ADD_USER_DIALOG").open()}}},[a("translate",[t._v("Add User")])],1)],1)],1)],1),t._v(" "),a("ui-dialog-delete-items",{attrs:{subject:t.$ngettext("user","users",t.select.length)},on:{"click:confirm":t.deleteUsers}}),t._v(" "),a("ui-dialog",{attrs:{id:"ADD_USER_DIALOG",theme:"safe"}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Add User")]),t._v(" "),a("template",{slot:"content"},[a("ui-form-element",{attrs:{vertical:"",group:"addProtectedDirUser",validators:{required:!0,validateUsername:t.validateUsername}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Username")]),t._v(" "),a("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.user,callback:function(e){t.user=e},expression:"user"}}),t._v(" "),a("translate",{attrs:{slot:"error:validateUsername"},slot:"error:validateUsername"},[t._v("\n                    User already exists\n                ")])],1),t._v(" "),a("ui-form-element",{attrs:{vertical:"",group:"addProtectedDirUser",validators:{required:!0}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Password")]),t._v(" "),a("input-password",{attrs:{slot:"content",showGenerator:""},slot:"content",model:{value:t.passwd,callback:function(e){t.passwd=e},expression:"passwd"}})],1)],1),t._v(" "),a("ui-button",{attrs:{slot:"buttons",theme:"safe",validateGroup:"addProtectedDirUser"},on:{click:t.addUser},slot:"buttons"},[a("translate",[t._v("Add")])],1)],2),t._v(" "),a("ui-dialog-confirm",{attrs:{id:"REMOVE_PROTECTION_DIALOG"},on:{"click:confirm":t.disableProtection}},[a("translate",{attrs:{"translate-params":{path:t.path}}},[t._v("\n            Are you sure you want to disable protection for %{path}?\n        ")])],1)],1)},s=[];a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return s}))}}]);