(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1425:function(t,e,n){"use strict";n.r(e);var r=n(3161),o=n(2242);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s=n(0),i=n(2974),u=n.n(i),l=Object(s.a)(o.default,r.a,r.b,!1,null,null,null);"function"==typeof u.a&&u()(l),e.default=l.exports},1529:function(t,e,n){"use strict";n.r(e);var r,o=n(30),a=n.n(o),s=n(6),i=n(35),u=n(18),l=function(){return(l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};!function(t){t.VALUE="value",t.CHECKBOX="checkbox"}(r||(r={}));var c=s.pipe(s.prop("keysize"),i.toSelectData),d=function(t,e){return l(l({id:t},e),{timestamp:Object(i.toAppDate)(e.timestamp)})},f={getKeys:{users:function(t){return u.Maybe.Some(t).flatMap((function(t){return u.Maybe.fromNull(t.users)})).orSome([])},options:s.prop("key_options"),sizes:c,public:function(t){return s.toPairs(t.public_keys).map(s.apply(d))},authorized:function(t){return s.values(t.authorized_keys).map(function(t){return function(e){var n=u.Maybe.Some(e).flatMap((function(t){return u.Maybe.fromNull(t.options)})).map(s.defaultTo({})).map(s.values).map(s.reduce((function(t,e){var n,r=e.name,o=e.value;return l(l({},t),((n={})[r]=o,n))}),{})).orSome({}),r=u.Maybe.Some(t).flatMap((function(t){return u.Maybe.fromNull(t.global_keys)})).flatMap((function(t){return u.Maybe.fromNull(t[e.fingerprint])})),o=r.map((function(t){return t.who})).orSome("no"),a=r.flatMap((function(t){return u.Maybe.fromNull(t.users)})).map(s.toPairs).map(s.filter(s.pipe(s.nth(1),s.prop("enabled"),s.equals("yes")))).map(s.map(s.head)).orSome([]);return l(l({},e),{options:n,global:o,users:"except"===o?s.without(a,t.users||[]):a})}}(t))}}};n.d(e,"getKeys",(function(){return v})),n.d(e,"createKey",(function(){return m})),n.d(e,"authorizeKeys",(function(){return h})),n.d(e,"deleteKeys",(function(){return b})),n.d(e,"deleteAuthorizedKeys",(function(){return _})),n.d(e,"pasteKey",(function(){return k})),n.d(e,"modifyKey",(function(){return g}));var p=function(){return(p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},y="/CMD_SSH_KEYS",v=a.a.get({id:"SSH_KEYS",url:y,mapResponse:f.getKeys,schema:{enabled_users:a.a.OPTIONAL_BOOL,fingerprint:a.a.OPTIONAL_STRING}}),m=a.a.post({url:y,params:{action:"create",type:"rsa"},schema:{id:a.a.REQUIRED_STRING,comment:a.a.REQUIRED_STRING,keysize:a.a.REQUIRED_STRING,passwd:a.a.OPTIONAL_STRING,overwrite:a.a.REQUIRED_BOOL,authorize:a.a.REQUIRED_BOOL},before:function(t){return{passwd2:t.passwd}}}),h=a.a.select({url:y,params:{type:"public",authorize:!0}}),b=a.a.select({url:y,params:{type:"public",delete:!0}}),_=a.a.select({url:y,params:{type:"authorized_keys",delete:!0}}),k=a.a.post({url:y,params:{type:"paste",action:"authorize"},schema:{text:a.a.REQUIRED_STRING}}),g=a.a.post({url:"/CMD_SSH_KEYS",params:{action:"modify"},schema:{fingerprint:a.a.REQUIRED_STRING,comment:a.a.REQUIRED_STRING,options:{type:Object,required:!0,default:function(){return{}}},global:a.a.REQUIRED_BOOL,users:{type:Array,required:!0,default:function(){return[]}},who:a.a.OPTIONAL_STRING},before:function(t){var e=t.options,n=t.users,r=t.global;return p(p({},e),{global_key:r,select:n,options:null,global:null,users:null})}})},2242:function(t,e,n){"use strict";n.r(e);var r=n(2243),o=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e.default=o.a},2243:function(t,e,n){"use strict";var r=n(1),o=n(10);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n(1529)),s=n(24),i=r(n(2970)),u=r(n(2971)),l=r(n(2972)),c=r(n(2973)),d={preload:a.getKeys,mixins:[(0,s.$bindTab)({defaultTab:"public",param:"tab"})],api:[{command:a.getKeys,bind:"keys"}],components:{CreateKeyDialog:i.default,PublicKeys:c.default,AuthorizedKeys:l.default,PasteKeyDialog:u.default},data:function(){return{checkedRows:[]}},computed:{checkedKeys:function(){return this.checkedRows.map((function(t){return t.fingerprint}))}},methods:{}};e.default=d},2244:function(t,e,n){"use strict";n.r(e);var r=n(2245),o=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e.default=o.a},2245:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1529),o={data:function(){return{id:"",comment:"",keysize:"",password:"",overwrite:!1,authorize:!1}},props:{keysizes:{type:Object,required:!0,default:function(){return{}}}},api:[{command:r.getKeys,bind:{"response.public":"keys"}}],computed:{keyData:function(){return{id:this.id,comment:this.comment,keysize:this.keysize,passwd:this.password,overwrite:this.overwrite,authorize:this.authorize}},keyNames:function(){return this.$api.keys.map((function(t){return t.id.replace("_rsa","")}))}},methods:{setKeysize:function(){this.keysize=this.keysizes.value},submit:function(){(0,r.createKey)(this.keyData).then((function(){return(0,r.getKeys)()})).then(this.$reset)}}};e.default=o},2246:function(t,e,n){"use strict";n.r(e);var r=n(2247),o=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e.default=o.a},2247:function(t,e,n){"use strict";var r=n(10);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(1529)),a={data:function(){return{text:""}},methods:{submit:function(){o.pasteKey({text:this.text}).then(o.getKeys).then(this.$reset)}}};e.default=a},2248:function(t,e,n){"use strict";n.r(e);var r=n(2249),o=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e.default=o.a},2249:function(t,e,n){"use strict";var r=n(10);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(1529)),a={api:[{command:o.getKeys,bind:{"response.authorized":"keys"}}],data:function(){return{checkedRows:[],keys:!1}},computed:{checkedKeys:function(){return this.checkedRows.map((function(t){return t.fingerprint}))},showGlobal:function(){return"user"!==this.$state.app.user.level}},methods:{reloadKeys:function(){o.getKeys(),this.$reset()},editKey:function(t){this.keys=this.$api.keys,this.$router.push({name:"user/ssh-keys/edit",params:{fingerprint:t}})},deleteKeys:function(){o.deleteAuthorizedKeys({select:this.checkedKeys}).then(this.reloadKeys)}}};e.default=a},2250:function(t,e,n){"use strict";n.r(e);var r=n(2251),o=n.n(r);for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);e.default=o.a},2251:function(t,e,n){"use strict";var r=n(10);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n(1529)),a={api:[{command:o.getKeys,bind:{"response.public":"keys"}}],data:function(){return{checkedRows:[]}},computed:{checkedKeys:function(){return this.checkedRows.map((function(t){return t.fingerprint}))}},methods:{reloadKeys:function(){o.getKeys(),this.checkedRows=[]},authorizeKeys:function(){o.authorizeKeys({select:this.checkedKeys}).then(this.reloadKeys)},deleteKeys:function(){o.deleteKeys({select:this.checkedKeys}).then(this.reloadKeys)}}};e.default=a},2970:function(t,e,n){"use strict";n.r(e);var r=n(3277),o=n(2244);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s=n(0),i=Object(s.a)(o.default,r.a,r.b,!1,null,null,null);e.default=i.exports},2971:function(t,e,n){"use strict";n.r(e);var r=n(3278),o=n(2246);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s=n(0),i=Object(s.a)(o.default,r.a,r.b,!1,null,null,null);e.default=i.exports},2972:function(t,e,n){"use strict";n.r(e);var r=n(3279),o=n(2248);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s=n(0),i=Object(s.a)(o.default,r.a,r.b,!1,null,null,null);e.default=i.exports},2973:function(t,e,n){"use strict";n.r(e);var r=n(3280),o=n(2250);for(var a in o)"default"!==a&&function(t){n.d(e,t,(function(){return o[t]}))}(a);var s=n(0),i=Object(s.a)(o.default,r.a,r.b,!1,null,null,null);e.default=i.exports},2974:function(t,e){},3161:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-page",[n("ui-button",{attrs:{slot:"header:buttons",theme:"primary"},on:{click:function(e){t.$dialog("CREATE_KEY_DIALOG").open()}},slot:"header:buttons"},[n("translate",[t._v("Create Key")])],1),t._v(" "),n("ui-button",{attrs:{slot:"header:buttons",theme:"safe"},on:{click:function(e){t.$dialog("PASTE_KEY_DIALOG").open()}},slot:"header:buttons"},[n("translate",[t._v("Paste Key")])],1),t._v(" "),n("app-page-section",[n("ui-tabs",{attrs:{tabs:[{id:"public",label:t.$gettext("Public Keys")},{id:"authorized",label:t.$gettext("Authorized Keys")}],selected:t.tab},on:{"update:selected":function(e){t.tab=e}}},[n("PublicKeys",{key:"public-keys",attrs:{slot:"tab:public"},slot:"tab:public"}),t._v(" "),n("AuthorizedKeys",{key:"authorized-keys",attrs:{slot:"tab:authorized"},slot:"tab:authorized"})],1)],1),t._v(" "),n("create-key-dialog",{attrs:{keysizes:t.$api.keys.sizes}}),t._v(" "),n("paste-key-dialog")],1)},o=[];n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}))},3277:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-dialog",{attrs:{id:"CREATE_KEY_DIALOG",size:"small"},on:{"dialog:open":t.setKeysize}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Create SSH Key")]),t._v(" "),n("template",{slot:"content"},[n("ui-form-element",{attrs:{vertical:"",group:"createKey",validators:{required:!0}}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Key ID")]),t._v(" "),n("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[t._v("Filename of the new key")]),t._v(" "),n("input-text",{attrs:{slot:"content",suffix:"_rsa",placeholder:"id"},slot:"content",model:{value:t.id,callback:function(e){t.id=e},expression:"id"}}),t._v(" "),n("translate",{attrs:{slot:"error:regex"},slot:"error:regex"},[t._v("\n                Should not contain special characters\n            ")])],1),t._v(" "),n("ui-form-element",{attrs:{vertical:""}},[n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.authorize,callback:function(e){t.authorize=e},expression:"authorize"}},[n("translate",[t._v("Authorize")])],1)],1),t._v(" "),n("transition",{attrs:{name:"fade"}},[t.keyNames.includes(t.id)?n("ui-form-element",{attrs:{vertical:""}},[n("span",{attrs:{slot:"title"},slot:"title"}),t._v(" "),n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.overwrite,callback:function(e){t.overwrite=e},expression:"overwrite"}},[n("translate",[t._v("Overwrite")])],1)],1):t._e()],1),t._v(" "),n("ui-form-element",{attrs:{group:"createKey",validators:{required:!0},vertical:""}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Comment")]),t._v(" "),n("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[t._v("Descriptor for the Key")]),t._v(" "),n("input-text",{attrs:{slot:"content",placeholder:"descriptive@comment.com"},slot:"content",model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}})],1),t._v(" "),n("ui-form-element",{attrs:{vertical:""}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Key size")]),t._v(" "),n("input-select",{attrs:{slot:"content",options:t.keysizes.options},slot:"content",model:{value:t.keysize,callback:function(e){t.keysize=e},expression:"keysize"}})],1),t._v(" "),n("ui-form-element",{attrs:{vertical:""}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Password")]),t._v(" "),n("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[t._v("Optional")]),t._v(" "),n("input-password",{attrs:{slot:"content"},slot:"content",model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"primary",disabled:t.keyNames.includes(t.id)&&!t.overwrite,validateGroup:"createKey"},on:{click:t.submit},slot:"buttons"},[n("translate",[t._v("Create")])],1)],2)},o=[];n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}))},3278:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-dialog",{attrs:{id:"PASTE_KEY_DIALOG",size:"normal"}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Paste Authorized Key")]),t._v(" "),n("ui-form-element",{attrs:{slot:"content",group:"pasteKey",validators:{required:!0},vertical:""},slot:"content"},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("Line")]),t._v(" "),n("input-text",{attrs:{slot:"content",placeholder:"(options) ssh-rsa ... comment"},slot:"content",model:{value:t.text,callback:function(e){t.text=e},expression:"text"}},[n("ui-link",{attrs:{slot:"additions:right",href:"https://man.openbsd.org/sshd#AUTHORIZED_KEYS_FILE_FORMAT",target:"_blank"},slot:"additions:right"},[n("ui-button",{attrs:{icon:"question"}})],1)],1)],1),t._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"safe",validateGroup:"pasteKey"},on:{click:t.submit},slot:"buttons"},[n("translate",[t._v("Create")])],1)],1)},o=[];n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}))},3279:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-r-table",{attrs:{columns:[{id:"comment",label:t.$gettext("Comment")},{id:"fingerprint",label:t.$gettext("Fingerprint")},{id:"type",label:t.$gettext("Type")},{id:"keysize",label:t.$gettext("Size")},{id:!!t.showGlobal&&"global",label:t.$gettext("Global Key")},{id:"options",label:t.$gettext("Options")}],rows:t.keys||t.$api.keys,checkedRows:t.checkedRows},on:{"update:checkedRows":function(e){t.checkedRows=e},"update:checked-rows":function(e){t.checkedRows=e}},scopedSlots:t._u([{key:"col:options",fn:function(e){var r=e.options;return n("ui-grid",{attrs:{column:""}},t._l(r,(function(e,r){return n("span",[t._v("\n            "+t._s(r)),e?[t._v(" = "+t._s(e))]:t._e()],2)})),0)}},{key:"col:global",fn:function(e){var r=e.global;return n("span",{},[t._v("\n        "+t._s({no:t.$gettext("No"),selected:t.$gettext("Selected Users"),all:t.$gettext("All Users"),except:t.$gettext("Except Selected Users")}[r])+"\n    ")])}},{key:"row:actions",fn:function(e){var r=e.fingerprint;return n("ui-link",{on:{click:function(e){return t.editKey(r)}}},[n("ui-icon",{attrs:{id:"pencil",size:"medium"}})],1)}}])},[n("ui-table-action",{attrs:{slot:"table:actions"},on:{click:t.deleteKeys},slot:"table:actions"},[n("translate",[t._v("Delete")])],1)],1)},o=[];n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}))},3280:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ui-r-table",{key:"public",attrs:{slot:"tab:public",columns:[{id:"id",label:t.$gettext("Key ID")},{id:"comment",label:t.$gettext("Comment")},{id:"fingerprint",label:t.$gettext("Fingerprint")},{id:"type",label:t.$gettext("Type")},{id:"keysize",label:t.$gettext("Size")}],rows:t.$api.keys,checkedRows:t.checkedRows},on:{"update:checkedRows":function(e){t.checkedRows=e},"update:checked-rows":function(e){t.checkedRows=e}},slot:"tab:public",scopedSlots:t._u([{key:"col:id",fn:function(e){var r=e.id;return n("a",{attrs:{href:"/CMD_FILE_MANAGER/.ssh/"+r+".pub",download:r+".pub"}},[t._v("\n        "+t._s(r)+"\n    ")])}}])},[n("template",{slot:"table:actions"},[n("ui-table-action",{on:{click:t.authorizeKeys}},[n("translate",[t._v("Authorize")])],1),t._v(" "),n("ui-table-action",{on:{click:t.deleteKeys}},[n("translate",[t._v("Delete")])],1)],1)],2)},o=[];n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}))}}]);