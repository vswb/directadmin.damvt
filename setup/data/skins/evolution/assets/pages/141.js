(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{1410:function(t,e,n){"use strict";n.r(e);var r=n(3146),o=n(2188);for(var i in o)"default"!==i&&function(t){n.d(e,t,(function(){return o[t]}))}(i);var s=n(0),l=n(2928),a=n.n(l),u=Object(s.a)(o.default,r.a,r.b,!1,null,null,null);"function"==typeof a.a&&a()(u),e.default=u.exports},2188:function(t,e,n){"use strict";n.r(e);var r=n(2189),o=n.n(r);for(var i in r)"default"!==i&&function(t){n.d(e,t,(function(){return r[t]}))}(i);e.default=o.a},2189:function(t,e,n){"use strict";var r=n(10),o=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n(20)),s=o(n(2)),l=o(n(15)),a=o(n(16)),u=r(n(2927)),c=r(n(6));function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){(0,s.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f,h,v={commands:u,preload:u.getHotlinkOptions,data:function(){return{allowBlankReferer:!1,urls:[],files:"",redirectTo:"forbidden",url:"",checkedRows:[],newUrl:""}},api:[{command:u.getHotlinkOptions,bind:{"response.urls":"urls","response.options":"options"}}],computed:{select:function(){return this.checkedRows.map((function(t){return t.url}))},urlString:function(){return this.urls.map((function(t){return t.url})).join("\n")},requestData:function(){return{enabled:this.$api.options.hotlinksEnabled?"yes":"no",allow_blank_referer:this.allowBlankReferer?"yes":"no",urls:this.urlString,files:this.files,redirect:this.redirectTo,redirect_url:this.url}}},created:function(){this.urls=c.clone(this.$api.urls),this.files=this.$api.options.files.join(","),this.allowBlankReferer=this.$api.options.hotlinkAllowBlankReferer,this.url=this.$api.options.url,this.redirectTo=this.$api.options.redirectTo},methods:{loadOptions:(h=(0,a.default)(l.default.mark((function t(){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.getHotlinkOptions();case 2:this.urls=c.clone(this.$api.urls);case 3:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)}),deleteUrls:(f=(0,a.default)(l.default.mark((function t(){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.deleteHotlinkUrls({select:this.select}).then(this.loadOptions);case 2:this.checkedRows=[];case 3:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)}),changeHotlinksStatus:function(t){u.saveOptions(p({},this.requestData,{enabled:t?"yes":"no"})).then(this.loadOptions)},saveOptions:function(){u.saveOptions(this.requestData).then(this.loadOptions)},addMyDomains:function(){var t=(0,i.default)(new Set([].concat((0,i.default)(this.urls.map((function(t){return t.url}))),(0,i.default)(this.$api.options.domains)))).join("\n");u.saveOptions(p({},this.requestData,{urls:t})).then(this.loadOptions)},addUrl:function(){this.urls.push({url:this.newUrl}),this.newUrl="",this.saveOptions()}}};e.default=v},2927:function(t,e,n){"use strict";var r=n(10),o=n(1);Object.defineProperty(e,"__esModule",{value:!0}),e.saveOptions=e.deleteHotlinkUrls=e.getHotlinkOptions=void 0;var i=o(n(2)),s=o(n(30)),l=r(n(6));n(35);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var c=s.default.get({id:"HOTLINK_OPTIONS",url:"/CMD_HOTLINK",params:{ipp:99999,page:1},domain:!0,mapResponse:{urls:l.pipe(l.prop("data"),l.omit("info"),l.values,l.filter(l.pipe(l.prop("url"),Boolean))),options:function(t){var e=t.options,n=function(t){return"checked"===e[t]};return{domains:t.options.MY_DOMAINS_LIST.split("\\n").filter(Boolean),hotlinkAllowBlankReferer:n("HOTLINK_ALLOW_BLANK_REFERER_CHECKED"),hotlinksEnabled:n("HOTLINK_ENALBED_CHECKED"),files:e.HOTLINK_PROTECT_FILES.split(","),redirectToForbidden:n("REDIRECT_TO_FORBIDDEN"),redirectToUrl:n("REDIRECT_TO_URL_CHECKED"),redirectTo:n("REDIRECT_TO_FORBIDDEN_CHECKED")?"forbidden":"url",url:e.REDIRECT_URL}}}});e.getHotlinkOptions=c;var d=s.default.select({url:"/CMD_HOTLINK",params:{action:"multiple",delete:!0},domain:!0});e.deleteHotlinkUrls=d;var p=s.default.post({url:"/CMD_HOTLINK",params:{action:"save"},domain:!0,schema:{enabled:u({},s.default.REQUIRED_STRING,{validator:function(t){return["yes","no"].includes(t)}}),allow_blank_referer:u({},s.default.REQUIRED_STRING,{validator:function(t){return["yes","no"].includes(t)}}),urls:s.default.REQUIRED_STRING,files:s.default.REQUIRED_STRING,redirect:u({},s.default.REQUIRED_STRING,{validator:function(t){return["forbidden","url"].includes(t)}}),redirect_url:s.default.OPTIONAL_STRING}});e.saveOptions=p},2928:function(t,e){},3146:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("app-page",[n("template",{slot:"header:buttons"},[t.$api.options.hotlinksEnabled?n("ui-button",{attrs:{theme:"danger",size:"big"},on:{click:function(e){return t.changeHotlinksStatus(!1)}}},[n("translate",[t._v("Disable Hotlinks Protection")])],1):n("ui-button",{key:"enableHotlinks",attrs:{theme:"safe",size:"big"},on:{click:function(e){return t.changeHotlinksStatus(!0)}}},[n("translate",[t._v("Enable Hotlinks Protection")])],1),t._v(" "),t.$api.options.hotlinksEnabled?n("ui-button",{attrs:{size:"big",theme:"primary"},on:{click:t.addMyDomains}},[n("translate",[t._v("Add My Domains")])],1):t._e()],1),t._v(" "),n("app-page-section",[n("ui-r-table",{attrs:{rows:t.urls,columns:[{id:"url",label:t.$gettext("URL")}],"is-sortable":"","is-checkable":"","disable-pagination":"","checked-rows":t.checkedRows,"vertical-layout":t.$_Client.isPhone},on:{"update:checkedRows":function(e){t.checkedRows=e},"update:checked-rows":function(e){t.checkedRows=e}}},[n("ui-table-action",{attrs:{slot:"table:actions"},on:{click:t.deleteUrls},slot:"table:actions"},[n("translate",[t._v("Delete")])],1)],1),t._v(" "),n("ui-input-group",{staticClass:"width:100%"},[n("input-text",{attrs:{slot:"input"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addUrl(e)}},slot:"input",model:{value:t.newUrl,callback:function(e){t.newUrl=e},expression:"newUrl"}}),t._v(" "),n("ui-button",{attrs:{slot:"additions:right",size:"normal",theme:"safe",disabled:!t.newUrl||"url"===t.redirectTo&&!t.url},on:{click:t.addUrl},slot:"additions:right"},[n("translate",[t._v("Add")])],1)],1),t._v(" "),n("ui-form-element",{attrs:{group:"hotlinkOptions",validators:{required:!0}}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Protected file types\n            ")]),t._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.files,callback:function(e){t.files=e},expression:"files"}})],1),t._v(" "),n("ui-form-element",[n("span",{attrs:{slot:"title"},slot:"title"}),t._v(" "),n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:t.allowBlankReferer,callback:function(e){t.allowBlankReferer=e},expression:"allowBlankReferer"}},[n("translate",[t._v("Allow Blank Referrer")])],1)],1),t._v(" "),n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                Redirect to\n            ")]),t._v(" "),n("div",{directives:[{name:"flex",rawName:"v-flex",value:{cross:"center"},expression:"{\n                    cross: 'center'\n                }"}],attrs:{slot:"content"},slot:"content"},[n("input-check",{attrs:{type:"radio",value:"forbidden"},model:{value:t.redirectTo,callback:function(e){t.redirectTo=e},expression:"redirectTo"}},[n("translate",[t._v("403 Forbidden")])],1),t._v(" "),n("input-check",{directives:[{name:"margin",rawName:"v-margin",value:[,,,1],expression:"[,,,1]"}],attrs:{type:"radio",value:"url"},model:{value:t.redirectTo,callback:function(e){t.redirectTo=e},expression:"redirectTo"}},[n("translate",[t._v("URL")])],1)],1)],1),t._v(" "),n("transition",{attrs:{name:"fade"}},["url"===t.redirectTo?n("ui-form-element",{attrs:{group:"hotlinkOptions",validators:{required:!0}}},[n("translate",{attrs:{slot:"title"},slot:"title"},[t._v("\n                    Redirect URL\n                ")]),t._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:t.url,callback:function(e){t.url=e},expression:"url"}})],1):t._e()],1),t._v(" "),n("ui-button",{attrs:{slot:"footer:buttons",theme:"safe","validate-group":"hotlinkOptions"},on:{click:t.saveOptions},slot:"footer:buttons"},[n("translate",[t._v("Save")])],1)],1)],2)},o=[];n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}))}}]);